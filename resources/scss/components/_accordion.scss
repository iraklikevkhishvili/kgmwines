@use "../.auto/abstracts.auto" as abs;

[data-accordion] {}

// [data-accordion-item]
.accordion__item {
    width: 100%;
}

//[data-accordion-header]
.accordion__header {
    display: flex;
    align-items: center;
    inline-size: 100%;
    min-block-size: 50px;
    height: 50px;
    position: relative;

    background: abs.$color-bg-muted;
    border: abs.$border solid abs.$color-border;
    border-block-start: none; // top border handled on first item
}

/* First item gets a top border for a continuous stack */
.accordion > .accordion__item:first-child .accordion__header {
    border-block-start: abs.$border solid abs.$color-border;
}

.accordion__header-button {
    display: flex;                 /* allow inner content alignment */
    align-items: center;
    justify-content: space-between;
    height: 100%;
    width: 100%;
    padding: 0;
    border: none;
    background: transparent;
    cursor: pointer;
}

/* --- Collapsible panel --- */
[data-accordion-content] {
    --acc-dur: var(--acc-dur-default, 300ms);
    --acc-ease: var(--acc-ease-default, ease-in-out);

    background: abs.$color-bg;
    overflow: hidden;
    block-size: auto;            /* for measuring scrollHeight */
    pointer-events: none;
    visibility: hidden;
    max-height: var(--acc-max, 0);

    transition:
        visibility 0s linear var(--acc-dur),
        max-height var(--acc-dur) var(--acc-ease);

    will-change: max-height;
}

/* OPEN state: show immediately, interactable */
[data-accordion-content][aria-hidden="false"] {
    pointer-events: auto;
    visibility: visible;
    transition-delay: 0s, 0s; /* visibility, max-height */
}

/* CLOSED state: delay visibility so the collapse can animate */
[data-accordion-content][aria-hidden="true"] {
    transition-delay: var(--acc-dur), 0s; /* visibility (delayed), max-height */
}

/* Inner body */
.accordion__content-inner {
    inline-size: 100%;
    border: abs.$border solid abs.$color-border;
    padding: abs.rem(16) abs.rem(32);
    border-block-start: none;  /* seam with header border */
}

/* Layout wrapper (optional demo constraints) */
.accordion {
    margin-inline: auto;
    inline-size: 800px;
    max-inline-size: 100%;
}

/* Respect user motion preferences */
@media (prefers-reduced-motion: reduce) {
    [data-accordion-content] {
        --acc-dur: 0s;
        transition: none;
    }
}
